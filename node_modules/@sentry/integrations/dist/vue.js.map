{"version":3,"file":"vue.js","sourceRoot":"","sources":["../src/vue.ts"],"names":[],"mappings":"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","sourcesContent":["import { Event, EventProcessor, Hub, Integration } from '@sentry/types';\nimport { getGlobalObject, isPlainObject } from '@sentry/utils';\n\n/** JSDoc */\ninterface Metadata {\n  [key: string]: any;\n  componentName?: string;\n  propsData?: {\n    [key: string]: any;\n  };\n  lifecycleHook?: string;\n}\n\n/** JSDoc */\nexport class Vue implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = Vue.id;\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Vue';\n\n  /**\n   * @inheritDoc\n   */\n  private readonly _Vue: any; // tslint:disable-line:variable-name\n\n  /**\n   * When set to false, Sentry will suppress reporting all props data\n   * from your Vue components for privacy concerns.\n   */\n  private readonly _attachProps: boolean = true;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: { Vue?: any; attachProps?: boolean } = {}) {\n    // tslint:disable-next-line: no-unsafe-any\n    this._Vue = options.Vue || getGlobalObject<any>().Vue;\n    if (options.attachProps === false) {\n      this._attachProps = false;\n    }\n  }\n\n  /** JSDoc */\n  private _formatComponentName(vm: any): string {\n    // tslint:disable:no-unsafe-any\n\n    if (vm.$root === vm) {\n      return 'root instance';\n    }\n    const name = vm._isVue ? vm.$options.name || vm.$options._componentTag : vm.name;\n    return (\n      (name ? `component <${name}>` : 'anonymous component') +\n      (vm._isVue && vm.$options.__file ? ` at ${vm.$options.__file}` : '')\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    // tslint:disable:no-unsafe-any\n\n    if (!this._Vue || !this._Vue.config) {\n      console.error('VueIntegration is missing a Vue instance');\n      return;\n    }\n\n    const oldOnError = this._Vue.config.errorHandler;\n\n    this._Vue.config.errorHandler = (error: Error, vm: { [key: string]: any }, info: string): void => {\n      const metadata: Metadata = {};\n\n      if (isPlainObject(vm)) {\n        metadata.componentName = this._formatComponentName(vm);\n\n        if (this._attachProps) {\n          metadata.propsData = vm.$options.propsData;\n        }\n      }\n\n      if (info !== void 0) {\n        metadata.lifecycleHook = info;\n      }\n\n      if (getCurrentHub().getIntegration(Vue)) {\n        getCurrentHub().withScope(scope => {\n          Object.keys(metadata).forEach(key => {\n            scope.setExtra(key, metadata[key]);\n          });\n\n          scope.addEventProcessor((event: Event) => {\n            if (event.sdk) {\n              const integrations = event.sdk.integrations || [];\n              event.sdk = {\n                ...event.sdk,\n                integrations: [...integrations, 'vue'],\n              };\n            }\n            return event;\n          });\n\n          getCurrentHub().captureException(error);\n        });\n      }\n\n      if (typeof oldOnError === 'function') {\n        oldOnError.call(this._Vue, error, vm, info);\n      }\n    };\n  }\n}\n"]}